(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) -> Node (x . 0, x . 1, x . 0)

0.0019 false

(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) -> Node (x . 0, x . 1, x . 0)

0.0036 false

(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) -> Node (x . 0, x . 1, x . 0)

0.0058 false

(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    Node (Node (Un_Node (x . 0) . 2, x . 1, Un_Node (x . 0) . 2),
           Un_Node (x . 0) . 1, Un_Node (x . 0) . 2)

0.0360 false

(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
=================================
None
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    Node (Un_Node (x . 0) . 0, Un_S (x . 1),
           Node (Un_Node (x . 0) . 0, x . 1, Un_Node (x . 0) . 0))

1.4571 false

(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
=================================
fix (f : tree * nat -> tree) = fun (x:tree * nat) -> x . 0

0.0128 false

(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    Node (Un_Node (x . 0) . 0, Un_S (x . 1),
           Node (Un_Node (x . 0) . 0, x . 1, Un_Node (x . 0) . 0))

0.1727 false

(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    Node (Node (Un_Node (x . 0) . 0, x . 1, Un_Node (x . 0) . 0),
           Un_Node (x . 0) . 1, Un_Node (x . 0) . 0)

0.3010 false

(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) = fun (x:tree * nat) -> x . 0

0.0375 false

(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
=================================
None
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
=================================
None
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) = fun (x:tree * nat) -> x . 0

0.0326 false

(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
=================================
None
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
=================================
fix (f : tree * nat -> tree) = fun (x:tree * nat) -> x . 0

0.0037 false

(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) = fun (x:tree * nat) -> x . 0

0.0221 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> x . 0

0.0133 false

(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
=================================
fix (f : tree * nat -> tree) = fun (x:tree * nat) -> x . 0

0.0108 false

(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    Node (Node (Un_Node (x . 0) . 0, x . 1, Un_Node (x . 0) . 0),
           Un_Node (x . 0) . 1, Un_Node (x . 0) . 2)

0.0935 false

(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> Node (Un_Node (x . 0) . 0, Un_S (x . 1),
                         f (Un_Node (x . 0) . 0, x . 1))

12.8909 false

(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
=================================
None
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match Un_Node (x . 0) . 1 with
                     | O _ -> x . 0
                     | S _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                     Un_Node (x . 0) . 1,
                                     Un_Node (x . 0) . 2))

0.8474 false

(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) = fun (x:tree * nat) -> x . 0

0.0043 false

(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match Un_Node (x . 0) . 1 with
      | O _ -> Node (Un_Node (x . 0) . 2, Un_Node (x . 0) . 1,
                      Node (Un_Node (x . 0) . 2, x . 1, Un_Node (x . 0) . 2))
      | S _ -> Node (Node (Un_Node (x . 0) . 0, x . 1, Un_Node (x . 0) . 0),
                      Un_Node (x . 0) . 1, Un_Node (x . 0) . 0)

53.6635 false

(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 1 with
      | O _ -> Node (Node (Un_Node (x . 0) . 2, x . 1, Un_Node (x . 0) . 2),
                      Un_Node (x . 0) . 1, Un_Node (x . 0) . 2)
      | S _ -> Node (Un_Node (x . 0) . 0, Un_S (x . 1),
                      Node (Un_Node (x . 0) . 2, x . 1, Un_Node (x . 0) . 2))

36.7749 false

(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match Un_Node (x . 0) . 1 with
      | O _ -> x . 0
      | S _ -> Node (Node (Un_Node (x . 0) . 2, x . 1, Un_Node (x . 0) . 2),
                      Un_Node (x . 0) . 1, Un_Node (x . 0) . 2)

0.0471 false

(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 1 with
      | O _ -> Node (Node (Un_Node (x . 0) . 0, x . 1, Un_Node (x . 0) . 0),
                      Un_Node (x . 0) . 1, Un_Node (x . 0) . 0)
      | S _ -> x . 0

0.1726 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
=================================
None
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
=================================
None
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
=================================
None
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
=================================
None
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
      | CEq _ -> x . 0
      | CGt _ -> x
      | CLt _ -> Node (Node (Un_Node (x . 0) . 0, x . 1, Un_Node (x . 0) . 0),
                        Un_Node (x . 0) . 1, Un_Node (x . 0) . 0)

2.1321 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match Un_Node (x . 0) . 1 with
                     | O _ -> x . 0
                     | S _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                     Un_Node (x . 0) . 1,
                                     Un_Node (x . 0) . 0))

0.0376 false

(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 1 with
      | O _ -> (match x . 0 with
                  | Leaf _ -> Node (x . 0, x . 1, x . 0)
                  | Node _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                     Un_Node (x . 0) . 1,
                                     Un_Node (x . 0) . 2))
      | S _ -> x . 0

0.6241 false

(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 2, Un_S (x . 1),
                                       f (Un_Node (x . 0) . 2, x . 1)))

0.7229 false

(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
=================================
None
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match Un_Node (x . 0) . 1 with
                     | O _ -> x . 0
                     | S _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                     Un_Node (x . 0) . 1,
                                     Un_Node (x . 0) . 2))

3.3202 false

(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 0)
                     | CLt _ -> Node (Un_Node (x . 0) . 0, Un_S (x . 1),
                                       f (Un_Node (x . 0) . 0, x . 1)))

0.1396 false

(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 2,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 0))

0.5277 false

(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> ()
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

2.4291 false

(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match comp_nat (Un_Node (x . 0) . 1) S (x . 1) with
      | CEq _ -> Node (Node (Un_Node (x . 0) . 2, x . 1, Un_Node (x . 0) . 2),
                        Un_Node (x . 0) . 1, Un_Node (x . 0) . 2)
      | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1), Un_Node (x . 0) . 1,
                        Un_Node (x . 0) . 2)
      | CLt _ -> x . 0

0.8429 false

(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> ())

6.9056 false

(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Node (Un_Node (x . 0) . 0, x . 1,
                                             Un_Node (x . 0) . 0),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 0)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_S (Un_S (x . 1)),
                                       Node (Un_Node (x . 0) . 0, x . 1,
                                              Un_Node (x . 0) . 0)))

1.1756 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
=================================
None
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> ())

46.8199 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 2, Un_S (x . 1),
                                       f (Un_Node (x . 0) . 2, x . 1)))

6.5581 false

(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 2, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

25.7253 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
=================================
None
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0, Un_S (x . 1),
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

9.2528 false

(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 2, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

84.8292 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 2, Un_S (x . 1),
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

48.0895 false

(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

7.7357 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0, Un_S (x . 1),
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

15.7458 false

(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 0, x . 1)))

11.0359 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 0, x . 1)))

62.7321 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

27.9176 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 0, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

5.9089 false

(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 2, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

0.7445 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 2, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

32.7463 false

(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0, Un_S (x . 1),
                                       f (Un_Node (x . 0) . 2, x . 1)))

10.6576 false

(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Leaf, x . 1), Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

24.5501 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

11.6425 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

62.5424 true

(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

20.8073 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 0, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

0.5940 false

(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

76.3951 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0, Un_S (x . 1),
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

14.4354 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

19.0593 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

39.1412 true

(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

3.2302 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Leaf, x . 1), Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

79.3835 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

28.2676 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

41.9660 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

21.6882 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Leaf, x . 1), Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

9.3533 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

3.7712 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

3.7813 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

73.5081 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Leaf, x . 1), Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

4.5529 false

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

3.8057 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
None
(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

77.5131 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

18.0452 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

58.7973 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (x . 1) (Un_Node (x . 0) . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1))
                     | CLt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2))

4.2800 true

(Leaf (), 0) -> Node (Leaf (), 0, Leaf ());
(Leaf (), 1) -> Node (Leaf (), 1, Leaf ());
(Leaf (), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Leaf (), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 1) -> Node (Leaf (), 1, Leaf ());
(Node (Leaf (), 1, Leaf ()), 2) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 0) -> Node (Leaf (), 0, Leaf ());
(Node (Leaf (), 0, Leaf ()), 1) -> Node (Leaf (), 0, Node (Leaf (), 1, Leaf ()));
(Node (Leaf (), 0, Leaf ()), 2) -> Node (Leaf (), 0, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 2, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 2, Leaf ()), 2) -> Node (Leaf (), 2, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 1) -> Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ());
(Node (Node (Leaf (), 0, Leaf ()), 1, Leaf ()), 2) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node(Leaf (), 2, Leaf ()));
(Node (Leaf (), 0, Node (Leaf (), 1, Leaf ())), 2) -> Node (Leaf (), 0, Node (Leaf (), 1, Node(Leaf (), 2, Leaf ())));
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 0) -> Node (Node (Node(Leaf (), 0, Leaf ()), 1, Leaf ()), 2, Leaf ());
(Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ()), 1) -> Node (Node (Leaf (), 1, Leaf ()), 2, Leaf ());
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 0) -> Node (Node (Leaf (), 0, Leaf ()), 1, Node (Leaf (), 2, Leaf ()));
(Node (Leaf (), 1, Node (Leaf (), 2, Leaf ())), 1) -> Node (Leaf (), 1, Node (Leaf (), 2, Leaf ()));
=================================
fix (f : tree * nat -> tree) =
  fun (x:tree * nat) ->
    match x . 0 with
      | Leaf _ -> Node (x . 0, x . 1, x . 0)
      | Node _ -> (match comp_nat (Un_Node (x . 0) . 1) (x . 1) with
                     | CEq _ -> x . 0
                     | CGt _ -> Node (f (Un_Node (x . 0) . 0, x . 1),
                                       Un_Node (x . 0) . 1,
                                       Un_Node (x . 0) . 2)
                     | CLt _ -> Node (Un_Node (x . 0) . 0,
                                       Un_Node (x . 0) . 1,
                                       f (Un_Node (x . 0) . 2, x . 1)))

3.0627 true

